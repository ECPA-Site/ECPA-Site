<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Minesweeper ‚Äî Secret Style</title>

  <style>
    :root{
      --bg:#0e0f11;--card:#15171c;--accent:#8ab4ff;--muted:#7a808a;--border:#1f2228;
      --cell:#1a1c22; --cell-hover:#22252c; --cell-open:#0f1114;
    }
    *{box-sizing:border-box; user-select:none}
    body{
      margin:0; min-height:100vh; display:grid; place-items:center;
      font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg); color:#e4e7eb; padding:20px;
    }
    .card{
      width:100%; max-width:480px; background:var(--card);
      border-radius:16px; padding:28px; border:1px solid var(--border);
      box-shadow:0 8px 30px rgba(0,0,0,0.4);
    }
    h1{
      font-size:24px; margin:0 0 6px; letter-spacing:.5px;
      text-transform:uppercase; text-align:center;
    }
    p.lead{color:var(--muted); font-size:14px; text-align:center; margin:0 0 18px;}

    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–Ω–æ–ø–æ–∫ */
    .top-bar{
      display:flex; justify-content:space-between;
      margin-bottom:16px; align-items:center;
    }

    .btn{
      background:var(--accent); color:#0a0d12; font-weight:600;
      padding:10px 14px; border-radius:12px; border:0; cursor:pointer;
      font-size:14px; transition:0.2s; text-transform:uppercase;
    }
    .btn:hover{background:#6da4ff}

    .counter{color:var(--muted); font-size:14px}

    /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
    .board{
      display:grid;
      gap:6px;
      justify-content:center;
      margin-top:10px;
    }
    .cell{
      width:36px; height:36px;
      background:var(--cell);
      border-radius:10px;
      display:flex; align-items:center; justify-content:center;
      font-size:18px; cursor:pointer;
      border:1px solid var(--border);
      transition:0.15s;
    }
    .cell:hover{background:var(--cell-hover)}
    .cell.open{
      background:var(--cell-open); cursor:default;
      border-color:#000;
    }
    .cell.mine{color:#ff6b6b;}
    .cell.flag{color:#ffd479;}

    .msg{
      margin-top:15px; text-align:center;
      font-size:15px; color:var(--muted);
      min-height:22px;
    }
  </style>
</head>

<body>
<main class="card">
  <h1>Minesweeper</h1>
  <p class="lead">Dark UI ‚Äî Secret Fund Style</p>

  <div class="top-bar">
    <div class="counter">Flags: <span id="flagCount">0</span></div>
    <button class="btn" id="restart">Restart</button>
  </div>

  <div id="board" class="board"></div>
  <div id="message" class="msg"></div>
</main>

<script>
/* –ü–ê–†–ê–ú–ï–¢–†–´ */
const SIZE = 8;
const MINES = 10;

let board = [];
let minePositions = [];
let flags = 0;
let revealed = 0;
let gameOver = false;

const boardEl = document.getElementById("board");
const msgEl = document.getElementById("message");
const flagCountEl = document.getElementById("flagCount");

boardEl.style.gridTemplateColumns = `repeat(${SIZE}, 36px)`;

/* –ó–∞–ø—É—Å–∫ */
init();

/* –†–µ—Å—Ç–∞—Ä—Ç */
document.getElementById("restart").onclick = init;

/* ------------ –õ–û–ì–ò–ö–ê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò ------------ */
function init(){
  board = [];
  minePositions = [];
  flags = 0;
  revealed = 0;
  gameOver = false;

  msgEl.textContent = "";
  flagCountEl.textContent = flags;

  boardEl.innerHTML = "";

  generateBoard();
  placeMines();
  calculateNumbers();
  renderBoard();
}

/* –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –∫–ª–µ—Ç–æ–∫ */
function generateBoard(){
  for(let r = 0; r < SIZE; r++){
    board[r] = [];
    for(let c = 0; c < SIZE; c++){
      board[r][c] = {
        r, c,
        mine:false,
        number:0,
        open:false,
        flag:false
      };
    }
  }
}

/* –†–∞—Å—Å—Ç–∞–≤–ª—è–µ–º –º–∏–Ω—ã */
function placeMines(){
  while(minePositions.length < MINES){
    let r = Math.floor(Math.random()*SIZE);
    let c = Math.floor(Math.random()*SIZE);
    let cell = board[r][c];
    if(!cell.mine){
      cell.mine = true;
      minePositions.push(cell);
    }
  }
}

/* –°—á–∏—Ç–∞–µ–º —Å–æ—Å–µ–¥–Ω–∏–µ –º–∏–Ω—ã */
function calculateNumbers(){
  for(let r=0;r<SIZE;r++){
    for(let c=0;c<SIZE;c++){
      if(board[r][c].mine) continue;
      board[r][c].number = neighbors(r,c).filter(n=>n.mine).length;
    }
  }
}

/* –°–ø–∏—Å–æ–∫ —Å–æ—Å–µ–¥–µ–π */
function neighbors(r,c){
  let list=[];
  for(let dr=-1; dr<=1; dr++){
    for(let dc=-1; dc<=1; dc++){
      if(dr===0 && dc===0) continue;
      let nr=r+dr, nc=c+dc;
      if(nr>=0 && nr<SIZE && nc>=0 && nc<SIZE){
        list.push(board[nr][nc]);
      }
    }
  }
  return list;
}

/* ------------ –†–ï–ù–î–ï–† ------------ */
function renderBoard(){
  for(let r=0;r<SIZE;r++){
    for(let c=0;c<SIZE;c++){
      const cell = board[r][c];
      const div = document.createElement("div");
      div.className = "cell";
      div.dataset.r = r;
      div.dataset.c = c;

      div.addEventListener("click", leftClick);
      div.addEventListener("contextmenu", rightClick);

      boardEl.appendChild(div);
    }
  }
}

/* ------------ –ö–õ–ò–ö–ò ------------ */
function leftClick(e){
  if(gameOver) return;

  const r = +e.target.dataset.r;
  const c = +e.target.dataset.c;
  const cell = board[r][c];

  if(cell.flag || cell.open) return;

  openCell(cell);
}

function rightClick(e){
  e.preventDefault();
  if(gameOver) return;

  const r = +e.target.dataset.r;
  const c = +e.target.dataset.c;
  const cell = board[r][c];

  if(cell.open) return;

  cell.flag = !cell.flag;
  flags += cell.flag ? 1 : -1;
  flagCountEl.textContent = flags;

  const div = getDiv(cell);
  div.textContent = cell.flag ? "‚öë" : "";
  div.classList.toggle("flag", cell.flag);
}

/* ------------ –û–¢–ö–†–´–¢–ò–ï –ö–õ–ï–¢–ö–ò ------------ */
function openCell(cell){
  if(cell.open) return;

  cell.open = true;
  revealed++;

  const div = getDiv(cell);
  div.classList.add("open");

  if(cell.mine){
    div.textContent = "üí•";
    div.classList.add("mine");
    gameLose();
    return;
  }

  if(cell.number > 0){
    div.textContent = cell.number;
  } else {
    div.textContent = "";
    neighbors(cell.r, cell.c).forEach(n => {
      if(!n.open && !n.mine) openCell(n);
    });
  }

  checkWin();
}

/* ------------ –ü–û–ò–°–ö DIV –ö–õ–ï–¢–ö–ò ------------ */
function getDiv(cell){
  return boardEl.children[cell.r * SIZE + cell.c];
}

/* ------------ –ü–†–û–ò–ì–†–´–® / –ü–û–ë–ï–î–ê ------------ */
function gameLose(){
  gameOver = true;
  msgEl.textContent = "üíÄ Game Over";

  minePositions.forEach(m=>{
    let d = getDiv(m);
    if(!m.open){
      d.textContent = "üí•";
      d.classList.add("mine","open");
    }
  });
}

function checkWin(){
  if(revealed === SIZE*SIZE - MINES){
    gameOver = true;
    msgEl.textContent = "üèÜ You Win!";
  }
}
</script>
</body>
</html>
